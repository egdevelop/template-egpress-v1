---
interface Props {
  categories: string[];
  activeCategory?: string;
}

const { categories, activeCategory } = Astro.props;

const allCategories = ['all', ...categories];
---

<div class="flex flex-wrap gap-2">
  {allCategories.map((category) => {
    const isActive = activeCategory === category || (!activeCategory && category === 'all');
    return (
      <button
        data-category={category}
        class={`category-filter px-4 py-2 rounded-full text-sm font-medium transition-all ${isActive ? 'active' : ''}`}
        style={isActive 
          ? `background-color: var(--color-primary); color: var(--color-text-inverse);` 
          : `background-color: var(--color-border); color: var(--color-text-secondary);`}
      >
        {category === 'all' ? 'All Posts' : category.replace('-', ' ')}
      </button>
    );
  })}
</div>

<script>
  const filterButtons = document.querySelectorAll('.category-filter');
  const blogCards = document.querySelectorAll('[data-blog-card]');

  filterButtons.forEach((button) => {
    button.addEventListener('click', () => {
      const category = button.getAttribute('data-category');
      
      filterButtons.forEach((btn) => {
        btn.classList.remove('active');
        (btn as HTMLElement).style.backgroundColor = 'var(--color-border)';
        (btn as HTMLElement).style.color = 'var(--color-text-secondary)';
      });
      
      button.classList.add('active');
      (button as HTMLElement).style.backgroundColor = 'var(--color-primary)';
      (button as HTMLElement).style.color = 'var(--color-text-inverse)';
      
      blogCards.forEach((card) => {
        const cardCategory = card.getAttribute('data-category');
        if (category === 'all' || cardCategory === category) {
          (card as HTMLElement).style.display = '';
        } else {
          (card as HTMLElement).style.display = 'none';
        }
      });
    });
  });
</script>
