---
import { isAdsenseEnabled, getAdConfig, getPublisherId, type AdSlot } from '../utils/adsense';

interface Props {
  location: AdSlot;
  class?: string;
}

const { location, class: className = '' } = Astro.props;

const enabled = isAdsenseEnabled();
const adConfig = getAdConfig(location);
const publisherId = getPublisherId();
const shouldShow = enabled && adConfig && adConfig.slot;
---

{shouldShow && adConfig && (
  <div class={`ads-placement ads-${location} ${className}`}>
    <ins 
      class="adsbygoogle"
      style="display:block"
      data-ad-client={publisherId}
      data-ad-slot={adConfig.slot}
      data-ad-format={adConfig.format || 'auto'}
      data-full-width-responsive={adConfig.responsive !== false ? 'true' : 'false'}
      {...(adConfig.layout ? { 'data-ad-layout': adConfig.layout } : {})}
    ></ins>
    <script is:inline>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
)}

<style>
  .ads-placement {
    margin: 1rem 0;
    text-align: center;
  }
  .ads-header {
    margin: 0.5rem 0;
  }
  .ads-footer {
    margin: 1rem 0;
  }
  .ads-inArticle {
    margin: 2rem 0;
  }
  .ads-beforeContent,
  .ads-afterContent {
    margin: 1.5rem 0;
  }
  .ads-sidebar {
    margin: 1rem 0;
  }
  .adsbygoogle {
    display: block;
  }
</style>
